<?php

// $a = 99;
// for ($i = 57; $i <= $a; $i++) {
//    if($i!=82 && $i!=60){
// // 11: 1,4,5,6,7,8,11,12,13,14,15,18,19,20,21,22,25,26,27,28,29
//           echo"
     
//     INSERT INTO attendance (`user_id`, `clock_in_time`, `clock_out_time`, `wifi_address`, `wifi_address_out`, `check_in`, `shift_id`, `earlyTime`, `lateLeaveTime`) 
// VALUES
// ('.$i.', '2024-12-02 07:55:00', '2024-12-02 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-03 07:50:00', '2024-12-03 17:06:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-04 07:51:00', '2024-12-04 16:45:00', '192.168.1.6', '192.168.1.6', 1, 3, 15, NULL),
// ('.$i.', '2024-12-05 08:14:00', '2024-12-05 17:11:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 14),
// ('.$i.', '2024-12-06 12:45:00', '2024-12-06 17:21:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, NULL),
// ('.$i.', '2024-12-09 07:45:00', '2024-12-09 17:13:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-10 07:48:00', '2024-12-10 17:11:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-11 07:33:00', '2024-12-11 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-12 07:43:00', '2024-12-12 17:03:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-13 07:59:00', '2024-12-13 17:16:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-16 07:55:00', '2024-12-16 17:08:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-17 08:30:00', '2024-12-17 17:13:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 30),
// ('.$i.', '2024-12-18 07:53:00', '2024-12-18 16:12:00', '192.168.1.6', '192.168.1.6', 1, 3, 48, NULL),
// ('.$i.', '2024-12-19 07:52:00', '2024-12-19 17:15:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-20 13:05:00', '2024-12-20 12:20:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, 5),
// ('.$i.', '2024-12-23 14:11:00', '2024-12-23 17:07:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, 71),
// ('.$i.', '2024-12-24 08:00:00', '2024-12-24 17:18:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-12-25 07:47:00', '2024-12-25 17:20:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-26 08:00:00', '2024-12-26 17:30:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-12-27 07:47:00', '2024-12-27 17:25:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-12-30 08:00:00', '2024-12-30 17:12:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-12-31 07:47:00', '2024-12-31 17:02:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL);
    
//     ";
    
//     }
   
// }
// $a = 99;

// for ($i = 57; $i <= $a; $i++) {
//     if($i!=82 && $i!=60){
// // 11: 1,4,5,6,7,8,11,12,13,14,15,18,19,20,21,22,25,26,27,28,29
//           echo"
     
//     INSERT INTO attendance (`user_id`, `clock_in_time`, `clock_out_time`, `wifi_address`, `wifi_address_out`, `check_in`, `shift_id`, `earlyTime`, `lateLeaveTime`) 
// VALUES
// ('.$i.', '2024-11-01 07:55:00', '2024-11-01 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),

// ('.$i.', '2024-11-04 07:51:00', '2024-11-04 16:45:00', '192.168.1.6', '192.168.1.6', 1, 3, 15, NULL),
// ('.$i.', '2024-11-05 08:14:00', '2024-11-05 17:11:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 14),
// ('.$i.', '2024-11-06 12:45:00', '2024-11-06 17:21:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, NULL),
// ('.$i.', '2024-11-07 07:50:00', '2024-11-07 17:06:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-08 07:50:00', '2024-11-08 17:06:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),

// ('.$i.', '2024-11-11 07:33:00', '2024-11-11 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-12 07:43:00', '2024-11-12 17:03:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-13 07:59:00', '2024-11-13 17:16:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-14 07:55:00', '2024-11-14 17:08:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-15 08:30:00', '2024-11-15 17:13:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 30),


// ('.$i.', '2024-11-18 07:53:00', '2024-11-18 16:12:00', '192.168.1.6', '192.168.1.6', 1, 3, 48, NULL),
// ('.$i.', '2024-11-19 07:52:00', '2024-11-19 17:15:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-20 13:05:00', '2024-11-20 12:20:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, 5),
// ('.$i.', '2024-11-21 14:11:00', '2024-11-21 17:07:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, 71),
// ('.$i.', '2024-11-22 08:00:00', '2024-11-22 17:18:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),

// ('.$i.', '2024-11-25 07:47:00', '2024-11-25 17:20:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-26 08:00:00', '2024-11-26 17:30:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-11-27 07:47:00', '2024-11-27 17:25:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-11-28 08:00:00', '2024-11-28 17:12:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-11-29 07:47:00', '2024-11-29 17:02:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL);
    
//     ";
    
//     }
   
// }
// $a = 99;
// for ($i = 57; $i <= $a; $i++) {
//     if($i!=82 && $i!=60){

//           echo"
     
//     INSERT INTO attendance (`user_id`, `clock_in_time`, `clock_out_time`, `wifi_address`, `wifi_address_out`, `check_in`, `shift_id`, `earlyTime`, `lateLeaveTime`) 
// VALUES 
// ('.$i.', '2024-10-01 07:55:00', '2024-10-01 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-02 07:55:00', '2024-10-02 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-03 07:50:00', '2024-10-03 17:06:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-04 07:51:00', '2024-10-04 16:45:00', '192.168.1.6', '192.168.1.6', 1, 3, 15, NULL),
// ('.$i.', '2024-10-07 08:14:00', '2024-10-07 17:11:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 14),
// ('.$i.', '2024-10-08 12:45:00', '2024-10-08 17:21:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, NULL),
// ('.$i.', '2024-10-09 07:45:00', '2024-10-09 17:13:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-10 07:48:00', '2024-10-10 17:11:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-11 07:33:00', '2024-10-11 17:01:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-14 07:43:00', '2024-10-14 17:03:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-15 07:59:00', '2024-10-15 17:16:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-16 07:55:00', '2024-10-16 17:08:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-17 08:30:00', '2024-10-17 17:13:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 30),
// ('.$i.', '2024-10-18 07:53:00', '2024-10-18 16:12:00', '192.168.1.6', '192.168.1.6', 1, 3, 48, NULL),
// ('.$i.', '2024-10-21 07:52:00', '2024-10-21 17:15:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-22 13:05:00', '2024-10-22 12:20:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, 5),
// ('.$i.', '2024-10-23 14:11:00', '2024-10-23 17:07:00', '192.168.1.6', '192.168.1.6', 2, 2, NULL, 71),
// ('.$i.', '2024-10-24 08:00:00', '2024-10-24 17:18:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-10-25 07:47:00', '2024-10-25 17:20:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-28 08:00:00', '2024-10-28 17:30:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-10-29 07:47:00', '2024-10-29 17:25:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL),
// ('.$i.', '2024-10-30 08:00:00', '2024-10-30 17:12:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, 60),
// ('.$i.', '2024-10-31 07:47:00', '2024-10-31 17:02:00', '192.168.1.6', '192.168.1.6', 1, 3, NULL, NULL);
    
//     ";
    
//     }
   
// }
?>
<?php
include('../../db/connetion.php');
class ProductManager extends Database {

    public function xuatmanvTheoId($dep_id) {
        $sql = 'SELECT manv FROM users WHERE department_id = :dep_id';
        $link = $this->getConnection();
        if ($link) {
            $stmt = $link->prepare($sql);
            $stmt->bindParam(':dep_id', $dep_id);
            $stmt->execute();
            $results = $stmt->fetchAll(PDO::FETCH_ASSOC);
            return $results ?: [];
        } else {
            return [];
        }
    }

    public function generateProductCode($type) {
        $uniqueNumber = str_pad(rand(0, 99999999), 8, '0', STR_PAD_LEFT);
        $prefix = $type === 'custom' ? "REQ" : ($type === 'template' ? "TPL" : "INVALID");
        return $prefix === "INVALID" ? "Invalid product type." : "{$prefix}-{$uniqueNumber}";
    }

   public function generateMultipleProductCodes($dep_id, $type, $count) {
        $manvList = $this->xuatmanvTheoId($dep_id);
        $codes = [];
        $manvCount = count($manvList);
        if ($manvCount === 0) {
            return "Không tìm thấy nhân viên cho phòng ban ID {$dep_id}.";
        }
        for ($i = 0; $i < $count; $i++) {
            $productCode = $this->generateProductCode($type);
            $codes[] = $productCode;
        }
        return $codes;
    }
}

// Khởi tạo đối tượng ProductManager
$productManager = new ProductManager();
// 1. Xuất mã sản phẩm loại "custom"
$type1 = 'custom';
$fullProductCodes1 = $productManager->generateMultipleProductCodes(3, $type1, 10);
echo "Danh sách mã sản phẩm loại {$type1}:<br>";
if (is_array($fullProductCodes1)) {
    foreach ($fullProductCodes1 as $code) {
        echo $code . "<br>";
    }
} else {
    echo $fullProductCodes1;
}

echo "<br>-------------------------------<br>";

// 2. Xuất mã sản phẩm loại "template"
$type2 = 'template';
$fullProductCodes2 = $productManager->generateMultipleProductCodes(3, $type2, 10);
echo "Danh sách mã sản phẩm loại {$type2}:<br>";
if (is_array($fullProductCodes2)) {
    foreach ($fullProductCodes2 as $code) {
        echo $code . "<br>";
    }
} else {
    echo $fullProductCodes2;
}

echo "<br>-------------------------------<br>";

// 3. Xuất danh sách manv theo ID phòng ban
$manvList = $productManager->xuatmanvTheoId(7);
echo "Danh sách mã nhân viên (manv) của phòng ban ID 7:<br>";
if (is_array($manvList)) {
    $dem = 1;
    foreach ($manvList as $manv) {
        // $dem . ": " .
        echo  $manv['manv'] . "<br>";
        $dem++;
    }
} else {
    echo $manvList;
}


?>
<?php
// // Giá trị a, b, c
// $a = 3;
// $b = 6;
// $c = 2;

// // Mảng lưu trữ tên 7 người
// $people = ['50', '67', '68', '79', '105', '106', '107'];

// // Khởi tạo mảng kết quả
// $results = [];

// // Tổng cộng a, b, c
// $total_a = 0;
// $total_b = 0;
// $total_c = 0;

// // Phân phối giá trị a, b, c cho các người sao cho tổng cộng đúng
// for ($i = 0; $i < 7; $i++) {
//     $distribution = '';

//     // Random cách phân phối a, b, c cho mỗi người sao cho tổng cộng đúng
//     // Tạo mảng cho a, b, c
//     $a_count = rand(0, $a - $total_a);  // Random a_count sao cho không vượt quá tổng a
//     $b_count = rand(0, $b - $total_b);  // Random b_count sao cho không vượt quá tổng b
//     $c_count = rand(0, $c - $total_c);  // Random c_count sao cho không vượt quá tổng c

//     // Điều chỉnh lại số lượng a, b, c sao cho tổng không vượt quá tổng ban đầu
//     $a_count = min($a_count, $a - $total_a); // Điều chỉnh lại a_count
//     $b_count = min($b_count, $b - $total_b); // Điều chỉnh lại b_count
//     $c_count = min($c_count, $c - $total_c); // Điều chỉnh lại c_count

//     // Cập nhật tổng và kết quả cho mỗi người
//     $total_a += $a_count;
//     $total_b += $b_count;
//     $total_c += $c_count;

//     // Tạo chuỗi phân phối theo dạng "aX,bY,cZ"
//     $distribution_parts = [];
//     if ($a_count > 0) {
//         $distribution_parts[] = "a" . $a_count;
//     }
//     if ($b_count > 0) {
//         $distribution_parts[] = "b" . $b_count;
//     }
//     if ($c_count > 0) {
//         $distribution_parts[] = "c" . $c_count;
//     }

//     // Kết hợp các phần lại với nhau
//     $distribution = implode(',', $distribution_parts);

//     // Lưu kết quả phân phối vào mảng
//     $results[$people[$i]] = $distribution;
// }

// // Kiểm tra tổng số lượng phân phối
// echo "Tổng số a: " . $total_a . "\n";
// echo "Tổng số b: " . $total_b . "\n";
// echo "Tổng số c: " . $total_c . "\n";

// // Hiển thị kết quả phân phối cho 7 người
// foreach ($results as $person => $distribution) {
//     echo '<br>' . $person . ": " . $distribution . "\n";
// }
?>
<?php
// Giá trị dịch vụ đã bán trong tháng
$sales_data = [
    'a' => 9, // Dịch vụ a bán được 9
    'b' => 1, // Dịch vụ b bán được 1
    'c' => 5  // Dịch vụ c bán được 5
];

// Ngày bắt đầu và kết thúc
$start_date = new DateTime('2024-10-04'); // Ngày bắt đầu: 4 tháng 11, 2024
$end_date = new DateTime('2024-11-03');   // Ngày kết thúc: 3 tháng 12, 2024

// Mảng lưu lịch sử bán hàng
$sales_history = [];

// Hàm random thời gian hành chính
function randomWorkingTime(DateTime $date) {
    $hour = rand(8, 16); // Giờ từ 8h đến 16h
    $minute = rand(0, 59); // Phút từ 0 đến 59
    return $date->setTime($hour, $minute);
}

// Phân phối số lượng bán cho từng loại dịch vụ
foreach ($sales_data as $service => $total_sales) {
    for ($i = 0; $i < $total_sales; $i++) {
        // Random ngày trong khoảng thời gian
        $random_date = clone $start_date;
        $days_diff = $end_date->diff($start_date)->days;
        $random_date->modify('+' . rand(0, $days_diff) . ' days');

        // Random thời gian hành chính
        $random_time = randomWorkingTime($random_date);

        // Lưu lại lịch sử bán hàng
        $sales_history[] = [
            'service' => $service,
            'date' => $random_time->format('Y-m-d H:i'),
        ];
    }
}

// Hiển thị kết quả
echo "Lịch sử bán hàng của nhân viên 50:\n";
foreach ($sales_history as $sale) {
    echo "- " . $sale['date'] . ": " . $sale['service'] . "<br>";
}
?>